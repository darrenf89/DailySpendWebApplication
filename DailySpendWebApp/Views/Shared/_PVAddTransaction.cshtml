@model DailySpendBudgetWebApp.Models.Transactions

@{
    string txtPayeeInfomration = "";
    string Payeecolor = "";
    if (Model.Payee == null || Model.Payee == "")
    {
        txtPayeeInfomration = "Select Payee";
        Payeecolor = "dark";
    }
    else
    {
        txtPayeeInfomration = Model.Payee;
        Payeecolor = "primary";
    }

    string txtCategoryInformation = "";
    string CategoryColor = "";
    if (Model.Category == null || Model.Category == "")
    {
        txtCategoryInformation = "Select Category";
        CategoryColor = "dark";
    }
    else
    {
        txtCategoryInformation = Model.Category;
        CategoryColor = "primary";
    }


    string txtSavingInformation = "";
    string SavingColor = "";
    string isSavingsChecked = "false";
    string SavingCategoryDisplay = "none";
    if (Model.isSpendFromSavings & (Model.SavingName != null | Model.SavingName != ""))
    {
        txtSavingInformation = @Model.SavingName;
        SavingColor = "primary";
        isSavingsChecked = "true";
        SavingCategoryDisplay = "flex";

    }
    else
    {
        txtSavingInformation = "";
        SavingColor = "dark";
    }

    string txtDateInformation = DateTime.Now.ToString("dd MMMM yyyy");
    string DateColor = "dark";
    if(Model.TransactionDate.GetValueOrDefault().Date != null)
    {
        txtSavingInformation = @Model.TransactionDate.GetValueOrDefault().ToString("dd MMMM yyyy");
        DateColor = "primary";
    }

    string AmountColor = "AmountRed";
    string AmountPlaceholder = "-£0.00";
    string AmountDatatype = "NegativeCurrency";
    if (Model.isIncome)
    {
        AmountColor = "AmountGreen";
        AmountPlaceholder = "£0.00";
        AmountDatatype = "PositiveCurrency";
    }

}

<div class="container p-0" style="min-height: 82vh;">
    <div>
        <div class="d-flex mb-1 ps-3 pe-3 justify-content-center">
            <div class="Transaction-Toggle col-11 bg-white" id="divTransactionType">
                <div class="d-flex justify-content-center align-items-center text-center">
                    <div class="col-6" id="divIncoming">
                        <input type="radio" id="rdbIncoming" name="TransactionToggleOption" value="Incoming" />
                        <label style="font-size:10pt" for="rdbIncoming" class="lblTransactionToggleOption pe-0">
                            <strong>Incoming &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+</strong>
                        </label>
                    </div>
                    <div class="col-6 text-white" id="divOutgoing">
                        <input type="radio" id="rdbOutgoing" name="TransactionToggleOption" value="Outgoing" />
                        <label style="font-size:10pt" for="rdbOutgoing" class="lblTransactionToggleOption ps-0">
                            <strong> - &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Outgoing </strong>
                        </label>
                    </div>
                    <input asp-for="isIncome" type="hidden" value="false" />
                </div>
            </div>
        </div>
    </div>
    <div id="divIsRegularSavingSelector" class="card text-white bg-white mt-5 mb-3 shadow rounded-5 border-dark" >
        <div id="divTransactionAmount" class="row justify-content-center align-items-center ms-2 me-2 mt-1">
            <input id="txtTransactionAmount" type="text" pattern="^£\d{1,3}(,\d{3})*(\.\d+)" value="" style="cursor: pointer; width: 75%; font-size: 25pt;" data-type="@AmountDatatype" placeholder="@AmountPlaceholder" class="@AmountColor pe-2 pt-2 pb-2 text-center" />
            <input asp-for="TransactionAmount" type="number" style="display:none;" />
            <span class="text-danger" asp-validation-for="TransactionAmount"></span>
        </div>
        <div id="divTransactionDetails" class="mt-2 p-1">
            <div id="divPayee" class="border-1 border-bottom border-dark bg-white">
                <a asp-controller="Transaction" asp-action="SelectPayee" >
                    <div class="d-flex justify-content-between">
                        <div class="text-left text-muted">
                            <p class="text-dark mt-3 mb-3 border-0 ps-2"><strong>Payee</strong></p>
                        </div>
                        <div class="text-right text-muted">
                            <p class="text-@Payeecolor mt-3 mb-3 pe-2" id="txtPayeeInformation"><strong>@txtPayeeInfomration</strong></p>
                        </div>
                    </div>                    
                </a>
                <input type="hidden" asp-for="Payee" />
            </div>
            <div id="divCategory" class="border-1 border-top border-bottom border-dark bg-white">
                <a asp-controller="Transaction" asp-action="SelectCategory">
                    <div class="d-flex justify-content-between">
                        <div class="text-left text-muted">
                            <p class="text-dark mt-3 mb-3 ps-2"><strong>Category</strong></p>
                        </div>
                        <div class="text-right text-muted">
                            <p id="txtCategoryInformation" class="text-@CategoryColor mt-3 mb-3 pe-2"><strong>@txtCategoryInformation</strong></p>
                        </div>
                    </div>                    
                </a>
                <input type="hidden" asp-for="Category" />
            </div>
            <div id="divFromSaving" class="d-flex flex-column border-1 border-top border-bottom border-dark bg-white">
                <div class="d-flex">
                    <input asp-for="isSpendFromSavings" type="checkbox" class="ms-2" checked="@isSavingsChecked" />
                    <p class="text-dark mt-3 mb-3 ps-3">
                        <strong>Spend Savings Money?!</strong>
                    </p>
                </div>
                <div id="divSavingCategory" class="border-1 border-top border-bottom border-dark" style="display: @SavingCategoryDisplay">
                    <a asp-controller="Transaction" asp-action="SelectSaving" class="bg-light">
                        <div class="d-flex justify-content-between">
                            <div class="text-left text-muted">
                                <p class="text-dark mt-2 mb-2 ps-2"><strong>Saving Category</strong></p>
                            </div>
                            <div class="text-right text-muted">
                                <p class="text-@SavingColor mt-2 mb-2 pe-2" id="txtSavingInformation"><strong>@txtSavingInformation</strong></p>
                            </div>
                        </div>
                    </a>
                    <input type="hidden" asp-for="SavingName" />
                    <input type="hidden" asp-for="SavingID" />
                </div>
            </div>
            <div id="divDate" class="border-1 border-top border-dark bg-white">
                <a onclick="">
                    <div class="d-flex justify-content-between">
                        <div class="text-left text-muted">
                            <p class="text-dark ps-2 mt-3 mb-3"><strong>Date</strong></p>
                        </div>
                        <div class="text-right text-muted">
                            <p class="text-@DateColor mt-3 mb-3 pe-2" id="txtDateInformation"><strong>@txtDateInformation</strong></p>
                        </div>
                        <input type="hidden" asp-for="TransactionDate" />
                    </div>
                </a>
            </div>
            <div id="divNote" class="mt-4 mb-5 align-items-start">
                <div>
                    <p class="text-dark ms-2 me-2 mb-0 p-0 h3">Enter a note:</p>
                </div>
                <div class="d-flex ms-2 me-2"> 
                    <input asp-for="Notes" type="text" class="col-12 p-0 pt-2 m-0 border-bottom border-2 border-success text-muted bg-white text-left h4" />
                </div>                
            </div>
        </div>
    </div>
</div>

<style>
    a:link {
        text-decoration: none;
    }
</style>

<script>

    $(document).ready(function () {
        $("#divCategory").hover(function () {
            $(this).addClass('bg-light').removeClass('bg-white');
        },
            function () {
                $(this).addClass('bg-white').removeClass('bg-light');
            });
    });

    $(document).ready(function () {
        $("#divPayee").hover(function () {
            $(this).addClass('bg-light').removeClass('bg-white');
        },
            function () {
                $(this).addClass('bg-white').removeClass('bg-light');
            });
    });

    $(document).ready(function () {
        $("#divDate").hover(function () {
            $(this).addClass('bg-light').removeClass('bg-white');
        },
            function () {
                $(this).addClass('bg-white').removeClass('bg-light');
            });
    });

    $(document).ready(function () {
        $("#divFromSaving").hover(function () {
            $(this).addClass('bg-light').removeClass('bg-white');
        },
            function () {
                $(this).addClass('bg-white').removeClass('bg-light');
            });
    });

    $(document).ready(LoadTransactionOutgoing());
    
    document.querySelectorAll('input[name="TransactionToggleOption"]').forEach(radio => {
        radio.addEventListener('click', HandleTransactionRadioClick);
    });

    function HandleTransactionRadioClick() {
        if (document.getElementById('rdbOutgoing').checked) {
            LoadTransactionOutgoing();
            NegativeformatCurrency($("#txtTransactionAmount"))
        }
        else if (document.getElementById('rdbIncoming').checked) {
            LoadTransactionIncoming();
            formatCurrency($("#txtTransactionAmount"))
        }
    }

    function LoadTransactionIncoming() {
        document.getElementById('isIncome').value = true;
        document.getElementById('divIncoming').style.backgroundColor = '#38b44a';
        document.getElementById('divOutgoing').style.backgroundColor = '#fff';
        document.getElementById('rdbOutgoing').checked = false;
        document.getElementById('rdbIncoming').checked = true;
        $('#txtTransactionAmount').addClass('AmountGreen').removeClass('AmountRed');
        $('#txtTransactionAmount').attr('data-type', 'PositiveCurrency');
        $('#txtTransactionAmount').attr('placeholder', '£0.00');
        $("input[data-type='PositiveCurrency']").on({
            keyup: function () {
                formatCurrency($(this));
            },
            blur: function () {
                formatCurrency($(this), "blur");
            }
        });
    }

    function LoadTransactionOutgoing() {
        document.getElementById('isIncome').value = false;
        document.getElementById('divIncoming').style.backgroundColor = '#fff';
        document.getElementById('divOutgoing').style.backgroundColor = '#e95420';
        document.getElementById('rdbOutgoing').checked = true;
        document.getElementById('rdbIncoming').checked = false;
        $('#txtTransactionAmount').addClass('AmountRed').removeClass('AmountGreen');
        $('#txtTransactionAmount').attr('data-type', 'NegativeCurrency');
        $('#txtTransactionAmount').attr('placeholder', '-£0.00');
        $("input[data-type='NegativeCurrency']").on({
            keyup: function () {
                NegativeformatCurrency($(this));
            },
            blur: function () {
                NegativeformatCurrency($(this), "blur");
            }
        });
    }





</script>